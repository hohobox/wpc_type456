/*******************************************************************************
**  FILE-NAME: Opf_Cfg.c                                                      **
**                                                                            **
**  MODULE-NAME: AUTOSAR OsProfiler Module                                    **
**                                                                            **
**  NOTE: This file is auto generated, do not edit this file manually.        **
**                                                                            **
********************************************************************************

********************************************************************************
**                      Generation Tool Information                           **
********************************************************************************
**  Tool Version: 1.5.8                                                       **
**                                                                            **
**  Change History: Refer log file (use -l option to generate log file)       **
**                                                                            **
********************************************************************************
**                      File Generation Information                           **
*******************************************************************************/

/*
 * INPUT FILE:    Configuration\ECU\Ecud_Os.arxml
 *                Configuration\ECU\Ecud_OsProfiler.arxml
 * GENERATED ON: The time-stamp is removed
 */

/*******************************************************************************
**                      Include Section                                       **
*******************************************************************************/
#include "Opf_Cfg.h"
#include "Opf_Ram.h"
#include "Opf_Port.h"
#if (OPF_TARGET_OS == OPF_FREESCALE_MPC560XB)
#include "Os.h"
#include "Os_internal_api.h"
#elif (OPF_TARGET_OS == OPF_RENESAS_RH850)
#include "Os_Cfg.h"
#elif (OPF_TARGET_OS == OPF_AUTRON_COMMON)
#include "Os.h"
#else
#error "Opf_Cfg.c : Target OS is not specified. Check configured OS type."
#endif

/*******************************************************************************
**                      OS Check                                              **
*******************************************************************************/
#if (OPF_TARGET_OS == OPF_FREESCALE_MPC560XB)
#if !defined(OSEXTSTATUS)
#error "Opf_Cfg.c : OS Profiler does not support STANDARD status"
#endif
#if defined(OSTIMER2)
#error "Opf_Cfg.c : OS Profiler does not support second system timer"
#endif
#elif (OPF_TARGET_OS == OPF_RENESAS_RH850)
#elif (OPF_TARGET_OS == OPF_AUTRON_COMMON)
#else
#error "Opf_Cfg.c : Specified OS is not valid"
#endif

/*******************************************************************************
**                      Global Data                                           **
*******************************************************************************/

/*******************************************************************************
**                      Initialization Structure                              **
*******************************************************************************/
#define OPF_START_SEC_VAR_INIT_UNSPECIFIED
#include "MemMap.h"

/* polyspace-begin MISRA-C3:8.7 [Not a Defect] "it is called for test application" */
VAR(Tdd_Opf_ProfileTaskInfo, OS_VAR) 
                                Opf_GaaProfileTaskInfo[OPF_PROFILE_TASK_COUNT] =
{
  /* OsTask_ASW_FG1_100ms */
  {
    /* ddTaskID */
    (OpfTaskIDType)0,
    /* Period of Task */
    0,    
    /* Min Slack Time */
    0xFFFFFFFFu,
    /* Max Jitter */
    0,
    /* Max Core Execution Time */
    0,
    /* Max Gross Execution Time */
    0,
    /* Response Time */
    0,
    /* E_OS_LIMIT count */
    0,
    
    /* Pointer to a task information */
    &Opf_GaaTaskInfo[0]
  },
  /* OsTask_ASW_FG1_10ms */
  {
    /* ddTaskID */
    (OpfTaskIDType)0,
    /* Period of Task */
    0,    
    /* Min Slack Time */
    0xFFFFFFFFu,
    /* Max Jitter */
    0,
    /* Max Core Execution Time */
    0,
    /* Max Gross Execution Time */
    0,
    /* Response Time */
    0,
    /* E_OS_LIMIT count */
    0,
    
    /* Pointer to a task information */
    &Opf_GaaTaskInfo[1]
  },
  /* OsTask_BSW_FG1_10ms */
  {
    /* ddTaskID */
    (OpfTaskIDType)0,
    /* Period of Task */
    0,    
    /* Min Slack Time */
    0xFFFFFFFFu,
    /* Max Jitter */
    0,
    /* Max Core Execution Time */
    0,
    /* Max Gross Execution Time */
    0,
    /* Response Time */
    0,
    /* E_OS_LIMIT count */
    0,
    
    /* Pointer to a task information */
    &Opf_GaaTaskInfo[2]
  },
  /* OsTask_BSW_FG1_100ms */
  {
    /* ddTaskID */
    (OpfTaskIDType)0,
    /* Period of Task */
    0,    
    /* Min Slack Time */
    0xFFFFFFFFu,
    /* Max Jitter */
    0,
    /* Max Core Execution Time */
    0,
    /* Max Gross Execution Time */
    0,
    /* Response Time */
    0,
    /* E_OS_LIMIT count */
    0,
    
    /* Pointer to a task information */
    &Opf_GaaTaskInfo[3]
  }
};

/* polyspace-end MISRA-C3:8.7 */


#define OPF_STOP_SEC_VAR_INIT_UNSPECIFIED
#include "MemMap.h"
/*******************************************************************************
**                      Functions                                             **
*******************************************************************************/
#define OPF_START_SEC_CODE
#include "MemMap.h"

FUNC(void, OPF_CODE) Opf_InitProfileTaskInfo(void)
{
  #if (OPF_TARGET_OS == OPF_RENESAS_RH850)
  uint8 LddIdx;
  #endif
  
  /* polyspace-begin CERT-C:INT30-C [Justified:Low] "In some cases, these macros are provided by the MCU manufacturer's OS" */
  Opf_GaaProfileTaskInfo[0].ddTaskID = (OpfTaskIDType)OsTask_ASW_FG1_100ms;
  Opf_GaaProfileTaskInfo[1].ddTaskID = (OpfTaskIDType)OsTask_ASW_FG1_10ms;
  Opf_GaaProfileTaskInfo[2].ddTaskID = (OpfTaskIDType)OsTask_BSW_FG1_10ms;
  Opf_GaaProfileTaskInfo[3].ddTaskID = (OpfTaskIDType)OsTask_BSW_FG1_100ms;

  /* polyspace-end CERT-C:INT30-C [Justified:Low] "In some cases, these macros are provided by the MCU manufacturer's OS" */

  #if (OPF_TARGET_OS == OPF_RENESAS_RH850)
  for(LddIdx = OPF_ZERO; LddIdx < Opf_Profile_Task_Count; LddIdx++)
  {
    Opf_GaaProfileTaskInfo[LddIdx].ddTaskID = Opf_GaaProfileTaskInfo[LddIdx].ddTaskID - 1024;
  }
  #endif
}


#if (OPF_TARGET_OS == OPF_FREESCALE_MPC560XB)
FUNC(OpfBool, OPF_CODE) Opf_IsNewTask(TaskType LucIdx)
{
  OpfBool LddIsNewTask = OPF_FALSE;

  if((OSTASKSTATUS(LucIdx) & OSTCBSTART) == OSTCBSTART)
  {
    LddIsNewTask = OPF_TRUE;
  }
  return LddIsNewTask;
}

FUNC(OpfBool, OPF_CODE) Opf_IsNoSuspendedTask(TaskType LucIdx)
{
  OpfBool LddIsNoSuspendedTask = OPF_FALSE;

  if(OSISTASKNOSUSPEND(LucIdx) != 0)
  {
    LddIsNoSuspendedTask = OPF_TRUE;
  }
  return LddIsNoSuspendedTask;
}

FUNC(OpfBool, OPF_CODE) Opf_IsAlarmTask(TaskType LucIdx)
{
  OSAlmType LucAlarmID;
  OSALMCB *LddAlarmCB;

  OpfBool LddIsAlarmTask = OPF_FALSE;
  OpfBool LddIsFound = OPF_FALSE;

  LucAlarmID = OsCounters[OSTIMER1].alarm;
  /* polyspace-begin MISRA-C3:11.3 [Justified:Low] "OSALMCB is the type of OS provided by MCU manufacturers" */
  /* polyspace-begin CERT-C:EXP36-C [Justified:Low] "OSALMCB is the type of OS provided by MCU manufacturers" */
  /* polyspace-begin CERT-C:EXP39-C [Justified:Low] "OSALMCB is the type of OS provided by MCU manufacturers" */
  LddAlarmCB = (OSALMCB*)LucAlarmID;

  while ((LddIsFound == OPF_FALSE) && (LddAlarmCB != (OSALMCB*)OSALMCBPTR0))
  {
    #if defined(OSALMCALLBACK)
    if (LddAlarmCB->callBack)
    {
      /* Pass */
    }
    else
    #endif  /* defined(OSALMCALLBACK) */
    #if defined(OSALMINCCOUNTER)
    if (LddAlarmCB->ctrIndexInc != OSCTR0)
    {
      /* Pass */
    }
    else
    #endif
    #if defined(OSALMSETEVENT) || defined(OSSCTSETEVENT)
    if (LddAlarmCB->action.event != 0u)
    {
      /* Pass */
    }
    else
    #endif
    {
      if(LddAlarmCB->action.taskIndex == LucIdx)
      {
    	LddIsAlarmTask = OPF_TRUE;
        LddIsFound = OPF_TRUE;
      }
    }

    LddAlarmCB = (OSALMCB*)(LddAlarmCB->next);
    /* polyspace-end MISRA-C3:11.3 [Justified:Low] "OSALMCB is the type of OS provided by MCU manufacturers" */
    /* polyspace-end CERT-C:EXP36-C [Justified:Low] "OSALMCB is the type of OS provided by MCU manufacturers" */
    /* polyspace-end CERT-C:EXP39-C [Justified:Low] "OSALMCB is the type of OS provided by MCU manufacturers" */
  }
  return LddIsAlarmTask;
}

#endif

#define OPF_STOP_SEC_CODE
#include "MemMap.h"
/*******************************************************************************
**                      End of File                                           **
*******************************************************************************/
